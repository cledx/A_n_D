<div class="row g-4">
  <!-- LEFT: fixed-size scrollable panel -->
  <div class="col-8">
    <div class="bg-light fill-page card-border overflow-y-auto pe-3">
      <% @display_messages.each do |message| %>
        <% if message.role == "user" %>
          <div class="chat-line d-flex flex-column align-items-end">
            <p class="me-2 m-0 text-primary"> <%= @character.name %> </p>
            <div class="chat-bubble py-1 px-2 border rounded-5 border-primary">
              <%= message.content %>
            </div>
          </div>
        <% else %>
          <div class="chat-line">
            <p class="me-2 m-0 text-primary"> Narrator </p>
            <div class="chat-bubble py-1 px-2 border rounded-5 border-primary">
              <%= message.content %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <!-- RIGHT: stacked panel + buttons + input + submit -->
  <div class="col-4">
    <div class="d-flex flex-column gap-2">
      <!-- Top right fixed-size bordered panel -->
      <div class="panel-top bg-light card-border">
        <div class="fw-semibold mb-2">Character</div>
        <div><%= @character.name %></div>
        <div>Level <%= @story.level %> - <%= @character.race %> <%= @character.character_class %></div>
        <div>[PROFILE_IMG.png]</div>
        <div>Health Points: <%= @story.health_points %></div>
      </div>

      <!-- Button 1 -->
      <%= button_to @story.messages.last.option_1,
          story_messages_path(@current_message.story_id),
          method: :post,
          params: {
              message: {
              content: @story.messages.last.option_1
              }
          },
          class: "btn btn-outline-dark pill-btn"
      %>

      <!-- Button 2 -->
      <%= button_to "#{@story.messages.last.option_2}",
          story_messages_path(@current_message.story_id),
          method: :post,
          params: {
              message: {
              content: @story.messages.last.option_2
              }
          },
          class: "btn btn-outline-dark pill-btn"
      %>

      <!-- Chat input + submit button -->
      <%= simple_form_for @message,
            url: story_messages_path(@current_message.story_id, @message),
            method: :post,
            html: { class: "mb-0" } do |f| %>

          <div class="panel panel--chat">
              <%= f.input :content,
                  as: :text,
                  label: false,
                  wrapper: false,
                  input_html: { class: "chat-textarea" },
                  placeholder: "Custom Choices go here..." %>
          </div>

        <div class="d-flex justify-content-end">
          <%= f.button :submit, "Submit", class: "btn btn-dark btn-sm submit-mini" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
